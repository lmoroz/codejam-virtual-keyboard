!function(t){var e={};function s(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var n=["","Escape:func:50::func:Esc","Backquote:char:::symbol:`~`~ёЁЁё","Digit1:char:::symbol:1!1!1!1!",'Digit2:char:::symbol:2@2@2"2"',"Digit3:char:::symbol:3#3#3№3№","Digit4:char:::symbol:4$4$4;4;","Digit5:char:::symbol:5%5%5%5%","Digit6:char:::symbol:6^6^6:6:","Digit7:char:::symbol:7&7&7?7?","Digit8:char:::symbol:8*8*8*8*","Digit9:char:::symbol:9(9(9(9(","Digit0:char:::symbol:0)0)0)0)","Minus:char:::symbol:-_-_-_-_","Equal:char:::symbol:=+=+=+=+","Backspace:func:auto:⟻ Backspace:func:Backspace","","Tab:func:80:Tab:symbol:\t\t\t\t\t\t\t\t","KeyQ:char:::letter:qQQqйЙЙй","KeyW:char:::letter:wWWwцЦЦц","KeyE:char:::letter:eEEeуУУу","KeyR:char:::letter:rRRrкККк","KeyT:char:::letter:tTTtеЕЕе","KeyY:char:::letter:yYYyнННн","KeyU:char:::letter:uUUuгГГг","KeyI:char:::letter:iIIiшШШш","KeyO:char:::letter:oOOoщЩЩщ","KeyP:char:::letter:pPPpзЗЗз","BracketLeft:char:::symbol:[{[{хХХх","BracketRight:char:::symbol:]}]}ъЪЪъ","Backslash:char:::symbol:\\|\\|/\\/\\","Delete:func:auto:Del:func:Delete","","CapsLock:func:auto:Caps Lock:func:CapsLock","KeyA:char:::letter:aAAaфФФф","KeyS:char:::letter:sSSsыЫЫы","KeyD:char:::letter:dDDdвВВв","KeyF:char:::letter:fFFfаААа","KeyG:char:::letter:gGGgпППп","KeyH:char:::letter:hHHhрРРр","KeyJ:char:::letter:jJJjоООо","KeyK:char:::letter:kKKkлЛЛл","KeyL:char:::letter:lLLlдДДд","Semicolon:char:::symbol:;:;:жЖЖж","Quote:char:::symbol:'\"'\"эЭЭэ","Enter:func:175:↵ Enter:symbol:\n\n\n\n\n\n\n\n","","ShiftLeft:func:auto::func:Shift","KeyZ:char:::letter:zZZzяЯЯя","KeyX:char:::letter:xXXxчЧЧч","KeyC:char:::letter:cCCcсССс","KeyV:char:::letter:vVVvмММм","KeyB:char:::letter:bBBbиИИи","KeyN:char:::letter:nNNnтТТт","KeyM:char:::letter:mMMmьЬЬь","Comma:char:::symbol:,<,<бББб","Period:char:::symbol:.>.>юЮЮю","Slash:char:::symbol:/?/?.,.,","ArrowUp:func::⇧:func:ArrowUp","ShiftRight:func:129::func:Shift","","ControlLeft:func:70:Ctrl:func:Control","MetaLeft:func::Win:func:Meta","AltLeft:func:::func:Alt","Space:space:auto:␣:symbol:        ","AltRight:func:::func:Alt","ArrowLeft:func::⇦:func:ArrowLeft","ArrowDown:func::⇩:func:ArrowDown","ArrowRight:func::⇨:func:ArrowRight","ControlRight:func:70:Ctrl:func:Control"];class a{constructor(t="textbox",e="textbox"){this.element=document.createElement("textarea"),this.element.setAttribute("id",t),this.element.value=this.content,(Array.isArray(e)?e:[e]).forEach(t=>this.element.classList.add(t)),document.body.prepend(this.element),this.caretPosition=0}set content(t){this.element.value=t,localStorage.cjvcTextcontent=t}get content(){return this.currentContent=localStorage.cjvcTextcontent||"",this.currentContent}addchar(t){const e=this.element.value,s=this.element.selectionStart,n=this.element.selectionEnd;this.setContent(e.substr(0,s),t,e.substr(n,e.length)),this.caretAt(n+1)}removeLeft(){const t=this.element.value,e=this.element.selectionStart-1,s=this.element.selectionEnd;this.setContent(t.substr(0,e),t.substr(s,t.length)),this.caretAt(e)}removeRight(){const t=this.element.value,e=this.element.selectionStart,s=this.element.selectionEnd+1;this.setContent(t.substr(0,e),t.substr(s,t.length)),this.caretAt(e)}setContent(...t){this.content=t.join("")}caretAt(t="end",e=!1){let s=t;if("end"===s){s=this.element.value.length}s<0&&(s=0),this.element.setSelectionRange(s,e||s),this.caretPosition=s}caretLeft(){this.caretAt(this.caretPosition-1)}caretRight(){this.caretAt(this.caretPosition+1)}}class r{constructor({keyProps:t,index:e,defaultSize:s="55",layouts:n=[]}){this.layouts={};const[,a,r,o,i,c,l]=t.match(/^([^:]+):([^:]+):([^:]*):([^:]*):([^:]+):((.|\n)+)$/i);this.code=a,this.type=c,this.layoutKeys=["symbol","letter"].includes(c)?l.split(""):new Array(8).fill(l),this.node=document.createElement("button"),this.node.setAttribute("tabindex",e+1),this.node.setAttribute("type","button"),this.node.setAttribute("data-key-code",a),["ArrowUp","ArrowDown"].includes(a)&&this.node.setAttribute("disabled",!0),this.node.classList.add("kbd__key"),this.node.classList.add(`kbd__key_${r}`),this.node.classList.add(`kbd__key_${c}`),this.node.classList.add(`kbd__key_${a}`);const h=o||s;h.match(/\d+/)&&(this.node.style.flex="0"),this.node.style.flexBasis=h.match(/\d+/)?`${h}px`:h,n.forEach((t,e)=>{this.node.setAttribute(`data-key-${t}`,i||this.layoutKeys[e]),this.layouts[t]=this.layoutKeys[e]})}event(t){this[t]()}keydown(){this.node.classList.add("active")}keyup(){this.node.classList.remove("active")}}class o{constructor({keymap:t,textbox:e,id:s="keyboard",layouts:n=["en"],classnames:a="kbd"}){this.langs=n,this.element=document.createElement("div"),this.element.setAttribute("id",s);const r=[this.lang];this.capsEnabled&&r.push("caps"),this.element.dataset.layout=r.join("-");const o=Array.isArray(a)?a:[a];o.forEach(t=>this.element.classList.add(t)),document.body.append(this.element),this.textbox=e,this.keys={},this.bypassKeys=["Enter","Escape","Backspace","Del","ArrowUp","ArrowLeft","ArrowDown","ArrowRight"],this.schortcutKeys=["KeyA","KeyC","KeyV","KeyX"],this.drawKeys(t,o);const i=document.createElement("div");i.classList.add("tip"),i.innerHTML='<span class="arrow">⬑ </span>Переключение раскладки: Shift+Alt физической или Win экранной клавиатуры',document.body.append(i)}get capsEnabled(){return this.capsEnabledInternal=!!parseInt(localStorage.cjvcCapsEnabled,10)||0,this.capsEnabledInternal}set capsEnabled(t){this.capsEnabledInternal=t?1:0,localStorage.cjvcCapsEnabled=this.capsEnabledInternal}get lang(){return this.langInternal=localStorage.cjvcLangName||"en",this.langInternal}set lang(t){this.langInternal=t,localStorage.cjvcLangName=this.langInternal}drawKeys(t,e){const s=document.createDocumentFragment();let n=!1;t.forEach((a,o)=>{if(!a)return void(o+1<t.length&&(n=document.createElement("div"),e.forEach(t=>n.classList.add(`${t}__row`)),s.append(n)));const i=new r({keyProps:a,index:o,layouts:this.langs});i.code&&(this.keys[i.code]=i),n.append(i.node)}),this.element.append(s)}keyEvent(t){if(!(t.code in this.keys))return;document.activeElement!==this.textbox.element&&(this.textbox.element.focus(),this.textbox.caretAt());let e=t.code;const s=[];this[t.type](e,t.type),this.schortcutKeys.includes(e)&&t.getModifierState("Control")||this.bypassKeys.includes(e)||(t.preventDefault(),"GroupNext"===e&&t.getModifierState("Alt")?e="ShiftLeft":"GroupNext"===e&&t.getModifierState("Shift")&&(e="AltLeft"),"func"===this.keys[e].type?("keydown"===t.type?(("GroupNext"===e||"AltLeft"===e&&t.getModifierState("Shift")||"ShiftLeft"===e&&t.getModifierState("Alt"))&&(this.lang="ru"===this.lang?"en":"ru"),s.push(this.lang),(t.getModifierState("Shift")||"Shift"===e)&&s.push("shift"),"CapsLock"===e&&this.capsEnabled||!t.getModifierState("CapsLock")&&"CapsLock"!==e?this.capsEnabled=!1:this.capsEnabled||"CapsLock"!==e&&!t.getModifierState("CapsLock")||(this.capsEnabled=!0)):(s.push(this.lang),t.getModifierState("Shift")&&s.push("shift")),this.capsEnabled&&s.push("caps"),this.element.dataset.layout=s.join("-")):"keydown"===t.type&&this.textbox.addchar(this.keys[e].layouts[this.element.dataset.layout]))}mouseEvent(t){const e=t.target.dataset.keyCode;if(!e)return;document.activeElement!==this.textbox.element&&(this.textbox.element.focus(),this.textbox.caretAt(this.textbox.caretPosition));const s=[];if("func"===this.keys[e].type){if("mousedown"===t.type)switch(s.push(this.lang),e){case"MetaLeft":this.lang="ru"===this.lang?"en":"ru",s[0]=this.lang;break;case"CapsLock":this.capsEnabled=this.capsEnabled?0:1;break;case"ShiftLeft":case"ShiftRight":s.push("shift");break;case"Escape":this.textbox.element.blur();break;case"Backspace":this.textbox.removeLeft();break;case"Delete":this.textbox.removeRight();break;case"ArrowLeft":this.textbox.caretLeft();break;case"ArrowRight":this.textbox.caretRight()}else s.push(this.lang);this.capsEnabled&&s.push("caps"),this.element.dataset.layout=s.join("-")}else"mousedown"===t.type&&this.textbox.addchar(this.keys[e].layouts[this.element.dataset.layout])}keydown(t){this.keys[t].keydown()}keyup(t){this.keys[t].keyup()}}var i=["en","en-shift","en-caps","en-shift-caps","ru","ru-shift","ru-caps","ru-shift-caps"];const c=t=>{const e=document.getElementsByTagName("HEAD")[0],s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=t,e.appendChild(s)};document.addEventListener("DOMContentLoaded",()=>{c("app.css"),c("https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap");const t=new a,e=new o({keymap:n,textbox:t,id:"kb",layouts:i}),s=e.keyEvent.bind(e),r=e.mouseEvent.bind(e);window.addEventListener("keydown",s),window.addEventListener("keyup",s),document.addEventListener("mousedown",r),document.addEventListener("mouseup",r)})}]);